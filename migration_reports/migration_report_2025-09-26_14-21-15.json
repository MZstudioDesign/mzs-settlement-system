{
  "timestamp": "2025-09-26T05:21:03.841Z",
  "phase": "failed",
  "backupName": "excel_production_migration_fixed_2025_09_26",
  "excelFile": "Ï†ïÏÇ∞ NEW ÏãúÌä∏.xlsm",
  "sheetsProcessed": [],
  "recordsMigrated": {},
  "validationResults": [],
  "errors": [
    "Error: Migration execution failed: Error: Command failed: npm run excel-etl -- --sheet=settlements --execute\n‚ö†Ô∏è Unknown category: 4-Î©îÎâ¥Ìåê 5-Î∏îÎ°úÍ∑∏Ïä§ÌÇ®\n‚ö†Ô∏è Unknown channel: 1-ÌÅ¨Î™Ω 2-Í≥ÑÏ¢å\n‚ö†Ô∏è Unknown category: Ïπ¥ÌÖåÍ≥†Î¶¨\n‚ö†Ô∏è Unknown channel: ÌîåÎû´Ìèº\n‚ö†Ô∏è Unknown category: 5\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 4\n‚ö†Ô∏è Unknown category: Ïπ¥ÎìúÎâ¥Ïä§\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 4\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: Î©îÎâ¥Ìåê\n‚ö†Ô∏è Unknown category: 3\n‚ö†Ô∏è Unknown category: Î©îÎâ¥Ìåê\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: Î©îÎâ¥Ìåê\n‚ö†Ô∏è Unknown category: 4\n‚ö†Ô∏è Unknown category: 5\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 5\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 5\n‚ö†Ô∏è Unknown category: 5\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 3\n‚ö†Ô∏è Unknown category: 5\n‚ö†Ô∏è Unknown category: 5\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 4\n‚ö†Ô∏è Unknown category: 5\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 5\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 3\n‚ö†Ô∏è Unknown category: 5\n‚ö†Ô∏è Unknown category: Î≥¥Îìú,Î∞∞ÎÑà\n‚ö†Ô∏è Unknown category: Î©îÎâ¥Ìåê\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: Î©îÎâ¥Ìåê\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: Ïπ¥ÎìúÎâ¥Ïä§\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: Ïπ¥ÎìúÎâ¥Ïä§\n‚ö†Ô∏è Unknown category: Ïπ¥ÎìúÎâ¥Ïä§\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 5\n‚ö†Ô∏è Unknown category: Ïπ¥ÎìúÎâ¥Ïä§\n‚ö†Ô∏è Unknown category: 3\n‚ö†Ô∏è Unknown category: Ïπ¥ÎìúÎâ¥Ïä§\n‚ö†Ô∏è Unknown category: Ïπ¥ÎìúÎâ¥Ïä§\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: Ïπ¥ÎìúÎâ¥Ïä§\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: ÏÉÅÏÑ∏ÌéòÏù¥ÏßÄ\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 5\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 5\n‚ö†Ô∏è Unknown category: 3\n‚ö†Ô∏è Unknown category: 3\n‚ö†Ô∏è Unknown category: 5\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 3\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 5\n‚ö†Ô∏è Unknown category: 4\n‚ö†Ô∏è Unknown category: 4\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 3\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 5\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 3\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 3\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 3\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 3\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 3\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 5\n‚ö†Ô∏è Unknown category: 4\n‚ö†Ô∏è Unknown category: Ïπ¥ÎìúÎâ¥Ïä§ Î©îÎâ¥Ìåê\n‚ö†Ô∏è Unknown category: 3\n‚ö†Ô∏è Unknown category: 4\n‚ö†Ô∏è Unknown category: 4\n‚ö†Ô∏è Unknown category: 5\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 4\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 3\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 3\n‚ö†Ô∏è Unknown category: Î©îÎâ¥Ìåê\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 4\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 4\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: Î∞∞ÎÑà\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 4\n‚ö†Ô∏è Unknown category: 4\n‚ö†Ô∏è Unknown category: 4\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 4\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 5\n‚ö†Ô∏è Unknown category: 5\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 4\n‚ö†Ô∏è Unknown category: 5\n‚ö†Ô∏è Unknown category: 5\n‚ö†Ô∏è Unknown category: 5\n‚ö†Ô∏è Unknown category: 3\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 5\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 4\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 5\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: Î∏îÎ°úÍ∑∏Ïä§ÌÇ®\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 3\n‚ö†Ô∏è Unknown category: 3\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 3\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 4\n‚ö†Ô∏è Unknown category: 4\n‚ö†Ô∏è Unknown category: 4\n‚ö†Ô∏è Unknown category: 5\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 5\n‚ö†Ô∏è Unknown category: 5\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: Ïπ¥ÎìúÎâ¥Ïä§\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 3\n‚ö†Ô∏è Unknown category: 4\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 4\n‚ö†Ô∏è Unknown category: 4\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 5\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 4\n‚ö†Ô∏è Unknown category: 4\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 5\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 4\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 3\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 4\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 3\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: Î©îÎâ¥Ìåê\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 4\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 4\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 5\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 2\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 4\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 4\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 5\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 1\n‚ö†Ô∏è Unknown category: 3\n‚ö†Ô∏è Unknown category: 2\n‚ùå Error importing to projects: Error: Failed to insert projects: Could not find the 'client_name' column of 'projects' in the schema cache\n    at importDataToTable (D:\\Ïû†ÍπêÎßåÎ®∏Î¨ºÍªò\\ÏõπÏÇ¨Ïù¥Ìä∏ ÎîîÏûêÏù∏\\mzs_sheet\\mzs-settlement-system\\scripts\\excel_etl_enhanced.ts:398:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async processSheet (D:\\Ïû†ÍπêÎßåÎ®∏Î¨ºÍªò\\ÏõπÏÇ¨Ïù¥Ìä∏ ÎîîÏûêÏù∏\\mzs_sheet\\mzs-settlement-system\\scripts\\excel_etl_enhanced.ts:450:5)\n    at async main (D:\\Ïû†ÍπêÎßåÎ®∏Î¨ºÍªò\\ÏõπÏÇ¨Ïù¥Ìä∏ ÎîîÏûêÏù∏\\mzs_sheet\\mzs-settlement-system\\scripts\\excel_etl_enhanced.ts:489:7)\n‚ùå Error processing sheet settlements: Error: Failed to insert projects: Could not find the 'client_name' column of 'projects' in the schema cache\n    at importDataToTable (D:\\Ïû†ÍπêÎßåÎ®∏Î¨ºÍªò\\ÏõπÏÇ¨Ïù¥Ìä∏ ÎîîÏûêÏù∏\\mzs_sheet\\mzs-settlement-system\\scripts\\excel_etl_enhanced.ts:398:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async processSheet (D:\\Ïû†ÍπêÎßåÎ®∏Î¨ºÍªò\\ÏõπÏÇ¨Ïù¥Ìä∏ ÎîîÏûêÏù∏\\mzs_sheet\\mzs-settlement-system\\scripts\\excel_etl_enhanced.ts:450:5)\n    at async main (D:\\Ïû†ÍπêÎßåÎ®∏Î¨ºÍªò\\ÏõπÏÇ¨Ïù¥Ìä∏ ÎîîÏûêÏù∏\\mzs_sheet\\mzs-settlement-system\\scripts\\excel_etl_enhanced.ts:489:7)\nüí• Excel ETL process failed: Error: Failed to insert projects: Could not find the 'client_name' column of 'projects' in the schema cache\n    at importDataToTable (D:\\Ïû†ÍπêÎßåÎ®∏Î¨ºÍªò\\ÏõπÏÇ¨Ïù¥Ìä∏ ÎîîÏûêÏù∏\\mzs_sheet\\mzs-settlement-system\\scripts\\excel_etl_enhanced.ts:398:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async processSheet (D:\\Ïû†ÍπêÎßåÎ®∏Î¨ºÍªò\\ÏõπÏÇ¨Ïù¥Ìä∏ ÎîîÏûêÏù∏\\mzs_sheet\\mzs-settlement-system\\scripts\\excel_etl_enhanced.ts:450:5)\n    at async main (D:\\Ïû†ÍπêÎßåÎ®∏Î¨ºÍªò\\ÏõπÏÇ¨Ïù¥Ìä∏ ÎîîÏûêÏù∏\\mzs_sheet\\mzs-settlement-system\\scripts\\excel_etl_enhanced.ts:489:7)\n",
    "Rollback failed: Error: Command failed: npm run migration-backup -- --action=rollback --name=excel_production_migration_fixed_2025_09_26"
  ],
  "totalDuration": 9814,
  "success": false,
  "backupPath": "D:\\Ïû†ÍπêÎßåÎ®∏Î¨ºÍªò\\ÏõπÏÇ¨Ïù¥Ìä∏ ÎîîÏûêÏù∏\\mzs_sheet\\mzs-settlement-system\\backups\\excel_production_migration_fixed_2025_09_26_*.json"
}